// =============================================================================
// BERK Hardware Bridge - Serial Port Demo
// USB/Serial iletiÅŸim Ã¶rneÄŸi
// =============================================================================

kullan std::serial

// -----------------------------------------------------------------------------
// Port KeÅŸfi
// -----------------------------------------------------------------------------

yazdÄ±r("=== BERK Serial Port Demo ===\n")

// Mevcut portlarÄ± listele
yazdÄ±r("ğŸ“¡ Mevcut Serial Portlar:")
yazdÄ±r("-" * 40)

olsun portlar = serial::list_ports()

eÄŸer portlar.uzunluk() == 0 ise
    yazdÄ±r("âš ï¸  HiÃ§ serial port bulunamadÄ±!")
    yazdÄ±r("    USB cihaz baÄŸlÄ± mÄ± kontrol edin.")
deÄŸilse
    her port iÃ§in portlar yap
        yazdÄ±r("  Port: {}", port["name"])
        yazdÄ±r("    Tip: {}", port["type"])
        eÄŸer port["manufacturer"] != boÅŸ ise
            yazdÄ±r("    Ãœretici: {}", port["manufacturer"])
        son
        eÄŸer port["vid"] != boÅŸ ise
            yazdÄ±r("    VID:PID: {:04X}:{:04X}", port["vid"], port["pid"])
        son
        yazdÄ±r("")
    son
son

// -----------------------------------------------------------------------------
// Basit Ä°letiÅŸim Ã–rneÄŸi (simÃ¼lasyon)
// -----------------------------------------------------------------------------

yazdÄ±r("\nğŸ“ Ã–rnek KullanÄ±m:")
yazdÄ±r("-" * 40)

yazdÄ±r("""
// Port aÃ§ma
olsun port = serial::open("COM3", 115200)

// Yazma
serial::write(port, "Merhaba Arduino!\\n")
serial::write_bytes(port, [0x01, 0x02, 0x03])

// Okuma
olsun yanit = serial::read_line(port)
yazdÄ±r("YanÄ±t: {}", yanit)

// Kapat
serial::close(port)
""")

// -----------------------------------------------------------------------------
// GeliÅŸmiÅŸ Ayarlar
// -----------------------------------------------------------------------------

yazdÄ±r("\nâš™ï¸  GeliÅŸmiÅŸ Port AyarlarÄ±:")
yazdÄ±r("-" * 40)

yazdÄ±r("""
// TÃ¼m parametrelerle aÃ§ma
olsun port = serial::open_extended(
    "COM3",     // Port adÄ±
    115200,     // Baud rate
    8,          // Data bits (5, 6, 7, 8)
    "none",     // Parity (none, odd, even)
    1           // Stop bits (1, 2)
)

// Timeout ayarla (ms)
serial::set_timeout(port, 1000)

// Kontrol sinyalleri
serial::set_dtr(port, doÄŸru)
serial::set_rts(port, doÄŸru)

// Buffer temizle
serial::flush(port)

// Okunacak byte sayÄ±sÄ±
olsun bekleyen = serial::available(port)
""")

yazdÄ±r("\nâœ… Serial demo tamamlandÄ±!")
