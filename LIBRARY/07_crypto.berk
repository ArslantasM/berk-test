// =============================================================================
// BERK Standard Library - Crypto Module Demo
// Åifreleme ve gÃ¼venlik iÅŸlemleri
// =============================================================================

kullan std::crypto

yazdÄ±r("=== BERK Crypto Demo ===\n")

// -----------------------------------------------------------------------------
// Hash FonksiyonlarÄ±
// -----------------------------------------------------------------------------

yazdÄ±r("ğŸ” Hash FonksiyonlarÄ±:")
yazdÄ±r("-" * 40)

olsun mesaj = "Merhaba BERK!"

// SHA-256
olsun sha256_hash = crypto::sha256(mesaj)
yazdÄ±r("SHA-256: {}", sha256_hash)

// SHA-512
olsun sha512_hash = crypto::sha512(mesaj)
yazdÄ±r("SHA-512: {}...", sha512_hash[0..32])

// MD5 (gÃ¼venlik iÃ§in Ã¶nerilmez, uyumluluk iÃ§in)
olsun md5_hash = crypto::md5(mesaj)
yazdÄ±r("MD5: {}", md5_hash)

// -----------------------------------------------------------------------------
// HMAC (Hash-based Message Authentication)
// -----------------------------------------------------------------------------

yazdÄ±r("\nğŸ”‘ HMAC:")
yazdÄ±r("-" * 40)

olsun anahtar = "gizli-anahtar-123"
olsun veri = "DoÄŸrulanacak veri"

olsun hmac = crypto::hmac_sha256(anahtar, veri)
yazdÄ±r("HMAC-SHA256: {}", hmac)

// DoÄŸrulama
olsun gecerli = crypto::hmac_verify(anahtar, veri, hmac)
yazdÄ±r("DoÄŸrulama: {}", eÄŸer gecerli ise "âœ“ GeÃ§erli" deÄŸilse "âœ— GeÃ§ersiz" son)

// -----------------------------------------------------------------------------
// Simetrik Åifreleme (AES)
// -----------------------------------------------------------------------------

yazdÄ±r("\nğŸ”’ AES Åifreleme:")
yazdÄ±r("-" * 40)

olsun aes_anahtar = crypto::generate_key(256)  // 256-bit anahtar
olsun iv = crypto::generate_iv()                // Initialization vector

olsun acik_metin = "Bu gizli bir mesajdÄ±r!"
yazdÄ±r("AÃ§Ä±k metin: {}", acik_metin)

// Åifrele
olsun sifreli = crypto::aes_encrypt(acik_metin, aes_anahtar, iv)
yazdÄ±r("Åifreli (base64): {}", sifreli)

// Ã‡Ã¶z
olsun cozulmus = crypto::aes_decrypt(sifreli, aes_anahtar, iv)
yazdÄ±r("Ã‡Ã¶zÃ¼lmÃ¼ÅŸ: {}", cozulmus)

// -----------------------------------------------------------------------------
// Asimetrik Åifreleme (RSA)
// -----------------------------------------------------------------------------

yazdÄ±r("\nğŸ” RSA Åifreleme:")
yazdÄ±r("-" * 40)

// Anahtar Ã§ifti oluÅŸtur
olsun [ozel_anahtar, acik_anahtar] = crypto::rsa_generate_keypair(2048)
yazdÄ±r("Anahtar Ã§ifti oluÅŸturuldu (2048-bit)")

olsun mesaj = "RSA ile ÅŸifrelenmiÅŸ mesaj"

// Public key ile ÅŸifrele
olsun rsa_sifreli = crypto::rsa_encrypt(mesaj, acik_anahtar)
yazdÄ±r("Åifreli: {}...", rsa_sifreli[0..32])

// Private key ile Ã§Ã¶z
olsun rsa_cozulmus = crypto::rsa_decrypt(rsa_sifreli, ozel_anahtar)
yazdÄ±r("Ã‡Ã¶zÃ¼lmÃ¼ÅŸ: {}", rsa_cozulmus)

// -----------------------------------------------------------------------------
// Dijital Ä°mza (Ed25519)
// -----------------------------------------------------------------------------

yazdÄ±r("\nâœï¸  Dijital Ä°mza (Ed25519):")
yazdÄ±r("-" * 40)

// Ä°mza anahtarlarÄ±
olsun [imza_ozel, imza_acik] = crypto::ed25519_generate_keypair()
yazdÄ±r("Ed25519 anahtar Ã§ifti oluÅŸturuldu")

olsun belge = "Bu belge imzalanacak"

// Ä°mzala
olsun imza = crypto::ed25519_sign(belge, imza_ozel)
yazdÄ±r("Ä°mza: {}...", imza[0..32])

// DoÄŸrula
olsun imza_gecerli = crypto::ed25519_verify(belge, imza, imza_acik)
yazdÄ±r("Ä°mza geÃ§erli: {}", imza_gecerli)

// -----------------------------------------------------------------------------
// Rastgele SayÄ± Ãœretimi
// -----------------------------------------------------------------------------

yazdÄ±r("\nğŸ² Kriptografik Rastgele SayÄ±lar:")
yazdÄ±r("-" * 40)

olsun rastgele_bytes = crypto::random_bytes(16)
yazdÄ±r("Rastgele 16 byte: {:?}", rastgele_bytes)

olsun uuid = crypto::uuid_v4()
yazdÄ±r("UUID v4: {}", uuid)

olsun token = crypto::generate_token(32)
yazdÄ±r("Token: {}", token)

// -----------------------------------------------------------------------------
// Base64 Kodlama
// -----------------------------------------------------------------------------

yazdÄ±r("\nğŸ“ Base64 Kodlama:")
yazdÄ±r("-" * 40)

olsun veri = "BERK programlama dili"

olsun encoded = crypto::base64_encode(veri)
yazdÄ±r("Encoded: {}", encoded)

olsun decoded = crypto::base64_decode(encoded)
yazdÄ±r("Decoded: {}", decoded)

yazdÄ±r("\nâœ… Crypto demo tamamlandÄ±!")
