// =============================================================================
// BERK Standard Library - Network Module Demo
// AÄŸ programlama
// =============================================================================

kullan std::network
kullan std::http

yazdÄ±r("=== BERK Network Demo ===\n")

// -----------------------------------------------------------------------------
// TCP Ä°stemci
// -----------------------------------------------------------------------------

yazdÄ±r("ğŸ”Œ TCP Ä°stemci:")
yazdÄ±r("-" * 40)

yazdÄ±r("""
kullan std::network

// Sunucuya baÄŸlan
olsun soket = network::tcp_connect("example.com", 80)
yazdÄ±r("BaÄŸlandÄ±!")

// Veri gÃ¶nder
network::send(soket, "GET / HTTP/1.1\\r\\n")
network::send(soket, "Host: example.com\\r\\n")
network::send(soket, "\\r\\n")

// YanÄ±t al
olsun yanit = network::recv(soket, 4096)
yazdÄ±r("YanÄ±t alÄ±ndÄ±: {} byte", yanit.uzunluk())

// Kapat
network::close(soket)
""")

// -----------------------------------------------------------------------------
// TCP Sunucu
// -----------------------------------------------------------------------------

yazdÄ±r("\nğŸ–¥ï¸  TCP Sunucu:")
yazdÄ±r("-" * 40)

yazdÄ±r("""
kullan std::network
kullan std::thread

// Sunucu oluÅŸtur
olsun sunucu = network::tcp_listen("0.0.0.0", 8080)
yazdÄ±r("Sunucu dinliyor: 0.0.0.0:8080")

dÃ¶ngÃ¼ yap
    // BaÄŸlantÄ± bekle
    olsun istemci = network::accept(sunucu)
    yazdÄ±r("Yeni baÄŸlantÄ±: {}", network::peer_addr(istemci))
    
    // Her istemci iÃ§in thread
    thread::spawn(fonksiyon() yap
        olsun veri = network::recv(istemci, 1024)
        yazdÄ±r("AlÄ±nan: {}", veri)
        
        network::send(istemci, "Merhaba Ä°stemci!\\n")
        network::close(istemci)
    son)
son
""")

// -----------------------------------------------------------------------------
// UDP
// -----------------------------------------------------------------------------

yazdÄ±r("\nğŸ“¡ UDP Ä°letiÅŸim:")
yazdÄ±r("-" * 40)

yazdÄ±r("""
// UDP soket oluÅŸtur
olsun udp = network::udp_bind("0.0.0.0", 9000)

// Veri gÃ¶nder
network::send_to(udp, "Merhaba!", "192.168.1.100", 9001)

// Veri al
olsun [veri, adres, port] = network::recv_from(udp, 1024)
yazdÄ±r("AlÄ±nan: {} from {}:{}", veri, adres, port)

network::close(udp)
""")

// -----------------------------------------------------------------------------
// HTTP Ä°stemci
// -----------------------------------------------------------------------------

yazdÄ±r("\nğŸŒ HTTP Ä°stemci:")
yazdÄ±r("-" * 40)

yazdÄ±r("""
kullan std::http

// GET isteÄŸi
olsun yanit = http::get("https://api.example.com/data")
yazdÄ±r("Status: {}", yanit.status)
yazdÄ±r("Body: {}", yanit.body)

// POST isteÄŸi
olsun post_yanit = http::post(
    "https://api.example.com/users",
    {"name": "BERK", "type": "language"},
    {"Content-Type": "application/json"}
)

// Header'lar ile GET
olsun auth_yanit = http::get_with_headers(
    "https://api.example.com/protected",
    {"Authorization": "Bearer token123"}
)

// Dosya indir
http::download("https://example.com/file.zip", "./downloads/file.zip")

// Dosya yÃ¼kle
http::upload("https://api.example.com/upload", "./myfile.txt")
""")

// -----------------------------------------------------------------------------
// DNS SorgularÄ±
// -----------------------------------------------------------------------------

yazdÄ±r("\nğŸ” DNS SorgularÄ±:")
yazdÄ±r("-" * 40)

yazdÄ±r("""
// IP adresini Ã§Ã¶z
olsun ip = network::resolve("example.com")
yazdÄ±r("example.com -> {}", ip)

// TÃ¼m IP'leri al
olsun ipler = network::resolve_all("google.com")
her ip iÃ§in ipler yap
    yazdÄ±r("  {}", ip)
son

// Ters DNS
olsun hostname = network::reverse_lookup("8.8.8.8")
yazdÄ±r("8.8.8.8 -> {}", hostname)
""")

// -----------------------------------------------------------------------------
// AÄŸ ArayÃ¼zleri
// -----------------------------------------------------------------------------

yazdÄ±r("\nğŸ”§ AÄŸ ArayÃ¼zleri:")
yazdÄ±r("-" * 40)

yazdÄ±r("""
olsun arayuzler = network::interfaces()

her arayuz iÃ§in arayuzler yap
    yazdÄ±r("ArayÃ¼z: {}", arayuz.name)
    yazdÄ±r("  MAC: {}", arayuz.mac)
    yazdÄ±r("  IPv4: {}", arayuz.ipv4)
    yazdÄ±r("  IPv6: {}", arayuz.ipv6)
    yazdÄ±r("  Aktif: {}", arayuz.is_up)
son

// Kendi IP adresimiz
olsun ip = network::local_ip()
yazdÄ±r("Yerel IP: {}", ip)

// Harici IP
olsun harici = network::external_ip()
yazdÄ±r("Harici IP: {}", harici)
""")

// -----------------------------------------------------------------------------
// WebSocket
// -----------------------------------------------------------------------------

yazdÄ±r("\nğŸ”„ WebSocket:")
yazdÄ±r("-" * 40)

yazdÄ±r("""
kullan std::websocket

// WebSocket baÄŸlantÄ±sÄ±
olsun ws = websocket::connect("wss://echo.websocket.org")

// Mesaj gÃ¶nder
websocket::send(ws, "Merhaba WebSocket!")

// Mesaj al
olsun mesaj = websocket::receive(ws)
yazdÄ±r("AlÄ±nan: {}", mesaj)

// Olay dÃ¶ngÃ¼sÃ¼
websocket::on_message(ws, fonksiyon(msg) yap
    yazdÄ±r("Mesaj: {}", msg)
son)

websocket::on_close(ws, fonksiyon() yap
    yazdÄ±r("BaÄŸlantÄ± kapandÄ±")
son)

// Kapat
websocket::close(ws)
""")

yazdÄ±r("\nâœ… Network demo tamamlandÄ±!")
